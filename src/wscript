def build(bld):
    from waflib.Tools import waf_unit_test
    bld.add_post_fun(waf_unit_test.summary)
    bld.program(
            source='main.cpp',
            target='renderer',
            use='easypng common camera pathtracer raytracer obj_loader',
            lib=['png', 'gomp'])

    objects = []

    for obj in objects:
        bld.objects(source=obj+'.cpp', target=obj)

    bld.objects(source='simpleObject.cpp', target='simpleObject', use='sphere solidColor')
    bld.objects(source='AreaLight.cpp', target='AreaLight', use='ray common')

    bld.recurse('core')
    bld.recurse('shapes')
    bld.recurse('file_loader')
    bld.recurse('materials')
    bld.recurse('kdtree')
    bld.recurse('render')

    if bld.env.TEST:
        bld.recurse('Tests')
